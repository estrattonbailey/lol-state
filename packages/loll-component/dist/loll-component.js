var t=require("nanomorph"),e=require("on-load"),n=e.KEY_ATTR,o=require("nanoassert");function r(t,e){var n={};for(var o in t)n[o]=t[o];for(var r in e)n[r]=e[r];return n}module.exports=function(a){o.ok("object"==typeof a,"component is not an object"),o.ok("function"==typeof a.render,"component.render() must be a function"),a.update&&o.ok("function"==typeof a.update,"component.update() must be a function");var u,f=!1;Object.assign(a,{state:{},ref:null,setState:function(e){if(!i(a.props,a.state))return function(){};var r="function"==typeof e?e(a.state):e;return o.ok("object"==typeof r,"setState received a value that was not an object"),Object.assign(a.state,r),function(){var e=a.render(a.props,a.state);u&&e.setAttribute(n,u),t(a.ref,e)}}});function i(t,e){return!a.update||a.update(t,e)}return function(t,s){if(void 0===s&&(s={}),o.ok("object"==typeof s,"external state passed to component must be an object"),console.log(s),a.ref||(a.init&&a.init(t,s),a.state=r(s,a.state),a.ref=a.render(t,a.state),a.props=t,(a.mount||a.unmount)&&(e(a.ref,function(){f||(f=!0,a.mount&&a.mount())},function(t){f&&(a.unmount&&a.unmount(),f=!1)},a),u=a.ref.getAttribute(n))),!i(t,r(s,a.state)))return a.ref;var c=s;a.props=t;for(var p in c)if(a.state[p]!==c[p]){a.setState(c)();break}return a.ref}};
//# sourceMappingURL=loll-component.js.map
